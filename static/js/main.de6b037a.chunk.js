(this["webpackJsonpregistration-page"]=this["webpackJsonpregistration-page"]||[]).push([[0],{29:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(20),r=n.n(c),i=(n(29),n(14)),o=n(2),l=n(8),j=n.n(l),u=n(10),b=n(3),d=n(21),O=n(22),h="https://pharmacy-rest.herokuapp.com/",m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GET",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{"Content-Type":"application/json"},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"include",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(d.a)(this,e),this.method=t,this.headers=n,this.credentials=a,this.body=s}return Object(O.a)(e,[{key:"getOptions",value:function(){return{method:this.method,headers:this.headers,credentials:this.credentials,body:this.body}}}]),e}(),f=n(0),p=s.a.createContext(),g=function(e){var t=e.children,n=Object(a.useState)(null),s=Object(b.a)(n,2),c=s[0],r=s[1],i=Object(a.useState)(null),o=Object(b.a)(i,2),l=o[0],j=o[1],u=Object(a.useState)(!1),d=Object(b.a)(u,2),O={user:c,setUser:r,isLoggedIn:d[0],setIsLoggedIn:d[1],userDetails:l,setUserDetails:j};return Object(f.jsx)(p.Provider,{value:O,children:t})},x=new m,v=function(){var e=Object(a.useState)(null),t=Object(b.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(null),r=Object(b.a)(c,2),i=r[0],o=r[1],l=Object(a.useState)(x.getOptions()),d=Object(b.a)(l,2),O=d[0],h=d[1],m=Object(a.useState)(null),f=Object(b.a)(m,2),p=f[0],g=f[1],v=Object(a.useState)(!1),_=Object(b.a)(v,2),N=_[0],w=_[1],y=Object(a.useRef)({});Object(a.useEffect)((function(){i&&function(){var e=Object(u.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(!0),!y.current[i]){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch(i,O);case 6:return t=e.sent,e.next=9,t.json();case 9:(n=e.sent).ok?(y.current[i]=n,s(n)):g(n.message),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),g(e.t0.message);case 16:w(!1);case 17:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(){return e.apply(this,arguments)}}()()}),[i,O]);return[{data:n,isLoading:N,error:p},function(e,t){o(e),t&&h(t)}]},_=(n(32),function(e){var t=e.message;return Object(f.jsx)("div",{className:"alert",children:Object(f.jsx)("p",{className:"alert__message",children:t})})}),N=(n(33),function(e){var t=e.title,n=e.to,a=Object(o.g)();return Object(f.jsx)("button",{className:"button",onClick:function(){return a.push(n)},children:t})}),w=(n(39),function(e){var t=e.children;return Object(f.jsx)("main",{className:"container",children:t})}),y=(n(40),function(){var e=v(),t=Object(b.a)(e,2),n=t[0],s=n.data,c=n.error,r=t[1],i=Object(a.useContext)(p),o=i.isLoggedIn,l=i.setIsLoggedIn,d=i.setUser,O=function(){var e=Object(u.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="".concat(h,"auth/logout"),n=new m,r(t,n.getOptions());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(null===s||void 0===s?void 0:s.ok)&&(l(!1),d(null))}),[s,l,d]),Object(f.jsx)(w,{children:Object(f.jsxs)("div",{className:"home",children:[Object(f.jsxs)("div",{className:"home__container",children:[c&&Object(f.jsx)(_,{message:c}),Object(f.jsx)("h2",{className:"home__container__title",children:o?"Already signed in":"Sign in"}),o?Object(f.jsx)("button",{className:"button",onClick:function(){return O()},children:"log out"}):Object(f.jsx)(N,{title:"sign in",to:"login"})]}),Object(f.jsxs)("div",{className:"home__container",children:[Object(f.jsx)("h2",{className:"home__container__title",children:"Don't have an account?"}),Object(f.jsx)(N,{title:"register",to:"register"})]})]})})}),k=(n(41),function(e){var t=e.children;return Object(f.jsx)("div",{className:"content-container",children:t})}),S=n(13),C=n(12),I=function(e,t,n,a){var s={};return[function(e){var t="";return e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(t="Invalid email address"):t="Insert email",{message:t,type:"email"}}(e),function(e){var t="";return e||(t="Insert password"),{message:t,type:"password"}}(t),"register"===a?function(e,t){var n="";return t?e!==t&&(n="Passwords must be the same"):n="Repeat password",{message:n,type:"repeatPassword"}}(t,n):null].forEach((function(e){return e&&e.message?s[e.type]=e.message:null})),s},L=(n(42),function(e){var t=e.handleOnChange,n=e.value,a=e.type,s=e.name,c=e.title,r=e.warning,i=Boolean(r)?"input--warning":"";return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"input__container",children:[Object(f.jsx)("label",{className:"label",children:c||s}),Object(f.jsx)("input",{className:"input ".concat(i),onChange:function(e){return t(e)},value:n||"",type:a,name:s})]}),Boolean(r)&&Object(f.jsx)(_,{message:r})]})}),P=(n(43),function(e){var t=e.type,n=e.callback,s=Object(a.useState)({}),c=Object(b.a)(s,2),r=c[0],i=c[1],l=Object(a.useState)({}),d=Object(b.a)(l,2),O=d[0],g=d[1],x=v(),N=Object(b.a)(x,2),w=N[0],y=w.data,k=(w.isLoading,w.error),P=N[1],E=Object(o.h)(),B=Object(a.useContext)(p),F=B.setUser,D=B.setIsLoggedIn,A=function(e){e.preventDefault();var t=e.target,n=t.value,a=t.name;i((function(e){return Object(C.a)(Object(C.a)({},e),{},Object(S.a)({},a,n))}))},U=function(){var e=Object(u.a)(j.a.mark((function e(n){var a,s,c,i,o,l,u;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=r.email,s=r.password,c=r.repeatPassword,Boolean(Object.keys(r).length)){e.next=5;break}return g({message:"Fill up form before submit"}),e.abrupt("return");case 5:if(i=I(a,s,c,t),!Boolean(Object.keys(i).length)){e.next=9;break}return g(i),e.abrupt("return");case 9:o=JSON.stringify(r),l=new m("POST",void 0,void 0,o),u="register"===t?"".concat(h,"user").concat(E.pathname):"".concat(h,"auth").concat(E.pathname),P(u,l);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){(null===y||void 0===y?void 0:y.user)&&(F(y.user),D(!0)),n&&(null===y||void 0===y?void 0:y.ok)&&n(!0),k&&g({message:k})}),[y,n,k,D,F]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("form",{className:"form",onSubmit:function(e){return U(e)},noValidate:!0,children:[Object(f.jsx)(L,{handleOnChange:A,value:r.email||"",type:"email",name:"email",warning:O.email||""}),Object(f.jsx)(L,{handleOnChange:A,value:r.password||"",type:"password",name:"password",warning:O.password||""}),"register"===t?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(L,{handleOnChange:A,value:r.repeatPassword||"",type:"password",name:"repeatPassword",title:"repeat password",warning:O.repeatPassword||""}),Object(f.jsx)(L,{handleOnChange:A,value:r.name||"",type:"text",name:"name"}),Object(f.jsx)(L,{handleOnChange:A,value:r.lastName||"",type:"text",name:"lastName",title:"last name"})]}):null,Object(f.jsx)("button",{className:"form__button",type:"submit",children:"register"===t?"Register":"Log In"})]}),Boolean(O.message)&&Object(f.jsx)(_,{message:O.message})]})}),E=(n(44),function(){var e=Object(a.useContext)(p).isLoggedIn;return Object(f.jsxs)(w,{children:[e&&Object(f.jsx)(o.a,{to:"/profile"}),Object(f.jsxs)(k,{children:[Object(f.jsx)("h1",{className:"content-container__title",children:"Log in"}),Object(f.jsx)(P,{})]}),Object(f.jsx)(N,{title:"home",to:"/"})]})}),B=(n(45),function(){var e=Object(a.useContext)(p).user;return Object(f.jsxs)("nav",{className:"nav",children:[Object(f.jsx)("div",{className:"nav__menu",children:Object(f.jsx)("i",{className:"fas fa-bars"})}),Object(f.jsxs)("div",{className:"nav__user",children:[Object(f.jsx)("p",{children:e?"Logged as ".concat(e.name||e.email):"No user logged in"}),Object(f.jsx)(i.b,{to:"/profile",children:Object(f.jsx)("i",{className:"fas fa-user"})})]})]})}),F=n(24),D=function(e){var t=e.component,n=Object(F.a)(e,["component"]),s=Object(a.useContext)(p).isLoggedIn;return Object(f.jsx)(o.b,{render:function(){return s?Object(f.jsx)(t,Object(C.a)({},n)):Object(f.jsx)(o.a,{to:"/login"})}})},A=(n(46),function(){var e=Object(a.useState)(null),t=Object(b.a)(e,2),n=t[0],s=t[1],c=Object(o.h)(),r="".concat(h,"user").concat(c.pathname),i=v(),l=Object(b.a)(i,2),j=l[0],u=j.data,d=j.error,O=l[1];return Object(a.useEffect)((function(){d||(O(r),(null===u||void 0===u?void 0:u.ok)&&s(u.user))}),[d,O,r,u]),Object(f.jsxs)(w,{children:[Object(f.jsxs)("div",{className:"profile",children:[d,n&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{className:"profile__title",children:"Profile"}),Object(f.jsxs)("p",{className:"profile__user",children:[n.name||"NO"," ",n.lastName||"NAME"]}),Object(f.jsx)("div",{className:"profile__avatar",children:Object(f.jsx)("div",{className:"profile__role",children:n.role[0]})}),Object(f.jsx)("p",{children:n.email})]})]}),Object(f.jsx)(N,{title:"home",to:"/"})]})}),U=(n(47),function(){return Object(f.jsxs)("div",{className:"footer",children:[Object(f.jsx)("p",{children:"By Piotr Dyrda"}),Object(f.jsxs)("div",{className:"footer__links",children:[Object(f.jsx)("div",{children:Object(f.jsx)("a",{href:"https://www.linkedin.com/in/dyrda-piotr/",target:"_blank",rel:"noreferrer",alt:"github-logo",children:Object(f.jsx)("i",{class:"fab fa-linkedin"})})}),Object(f.jsx)("div",{children:Object(f.jsx)("a",{href:"https://github.com/dyrpit",target:"_blank",rel:"noreferrer",alt:"github-logo",children:Object(f.jsx)("i",{class:"fab fa-github"})})})]})]})}),J=(n(48),function(){var e=Object(a.useState)(!1),t=Object(b.a)(e,2),n=t[0],s=t[1];return Object(f.jsxs)(w,{children:[Object(f.jsx)(k,{children:n?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{className:"content-container__title",children:"Hurray you have successfully registered"}),Object(f.jsx)(N,{title:"log in",to:"/login"})]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{className:"content-container__title",children:"sign in"}),Object(f.jsx)(P,{type:"register",callback:s})]})}),Object(f.jsx)(N,{title:"home",to:"/"})]})});var R=function(){return Object(f.jsxs)(g,{children:[Object(f.jsxs)(i.a,{basename:"/registration-panel",children:[Object(f.jsx)(B,{}),Object(f.jsxs)(o.d,{children:[Object(f.jsx)(o.b,{exact:!0,path:"/",component:y}),Object(f.jsx)(o.b,{path:"/login",component:E}),Object(f.jsx)(o.b,{path:"/register",component:J}),Object(f.jsx)(D,{path:"/profile",component:A})]})]}),Object(f.jsx)(U,{})]})};r.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(R,{})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.de6b037a.chunk.js.map